<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Bomb Lab | 随便寻个地方'Blog</title><meta name="author" content="随便寻个地方"><meta name="copyright" content="随便寻个地方"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Bomb Lab简介这是HNU计算机系统课程的第三次实验，实验要求是给一个用C语言编写的可执行文件bomb，你可以看到它主函数的C语言代码，除此之外，一概不知，实验分为六个阶段，每个阶段需要输入一串字符，以此来破译炸弹的密码，如果六次输入的密码都是正确的，则炸弹拆除，否则炸弹爆炸（退出并打印爆炸信息）。为了防止学生互相借鉴，HNU采用了最传统的防作弊方式——让每个学生做不同的题目。这次实验好行并没">
<meta property="og:type" content="article">
<meta property="og:title" content="Bomb Lab">
<meta property="og:url" content="http://example.com/2023/04/18/Bomb-Lab/index.html">
<meta property="og:site_name" content="随便寻个地方&#39;Blog">
<meta property="og:description" content="Bomb Lab简介这是HNU计算机系统课程的第三次实验，实验要求是给一个用C语言编写的可执行文件bomb，你可以看到它主函数的C语言代码，除此之外，一概不知，实验分为六个阶段，每个阶段需要输入一串字符，以此来破译炸弹的密码，如果六次输入的密码都是正确的，则炸弹拆除，否则炸弹爆炸（退出并打印爆炸信息）。为了防止学生互相借鉴，HNU采用了最传统的防作弊方式——让每个学生做不同的题目。这次实验好行并没">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/touxiang.png">
<meta property="article:published_time" content="2023-04-18T12:52:18.000Z">
<meta property="article:modified_time" content="2024-06-11T16:03:26.646Z">
<meta property="article:author" content="随便寻个地方">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/touxiang.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/04/18/Bomb-Lab/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Bomb Lab',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-06-12 00:03:26'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="随便寻个地方'Blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/touxiang.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">43</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="随便寻个地方'Blog"><span class="site-name">随便寻个地方'Blog</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Bomb Lab</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-04-18T12:52:18.000Z" title="发表于 2023-04-18 20:52:18">2023-04-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-06-11T16:03:26.646Z" title="更新于 2024-06-12 00:03:26">2024-06-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9D%82/">杂</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Bomb Lab"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Bomb-Lab"><a href="#Bomb-Lab" class="headerlink" title="Bomb Lab"></a>Bomb Lab</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>这是HNU计算机系统课程的第三次实验，实验要求是给一个用C语言编写的可执行文件bomb，你可以看到它主函数的C语言代码，除此之外，一概不知，实验分为六个阶段，每个阶段需要输入一串字符，以此来破译炸弹的密码，如果六次输入的密码都是正确的，则炸弹拆除，否则炸弹爆炸（退出并打印爆炸信息）。为了防止学生互相借鉴，HNU采用了最传统的防作弊方式——让每个学生做不同的题目。这次实验好行并没有什么评分标准，所以可以不断测试自己的答案。</p>
<h2 id="C语言源代码"><a href="#C语言源代码" class="headerlink" title="C语言源代码"></a>C语言源代码</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***************************************************************************</span></span><br><span class="line"><span class="comment"> * Dr. Evil&#x27;s Insidious Bomb, Version 1.1</span></span><br><span class="line"><span class="comment"> * Copyright 2011, Dr. Evil Incorporated. All rights reserved.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * LICENSE:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Dr. Evil Incorporated (the PERPETRATOR) hereby grants you (the</span></span><br><span class="line"><span class="comment"> * VICTIM) explicit permission to use this bomb (the BOMB).  This is a</span></span><br><span class="line"><span class="comment"> * time limited license, which expires on the death of the VICTIM.</span></span><br><span class="line"><span class="comment"> * The PERPETRATOR takes no responsibility for damage, frustration,</span></span><br><span class="line"><span class="comment"> * insanity, bug-eyes, carpal-tunnel syndrome, loss of sleep, or other</span></span><br><span class="line"><span class="comment"> * harm to the VICTIM.  Unless the PERPETRATOR wants to take credit,</span></span><br><span class="line"><span class="comment"> * that is.  The VICTIM may not distribute this bomb source code to</span></span><br><span class="line"><span class="comment"> * any enemies of the PERPETRATOR.  No VICTIM may debug,</span></span><br><span class="line"><span class="comment"> * reverse-engineer, run &quot;strings&quot; on, decompile, decrypt, or use any</span></span><br><span class="line"><span class="comment"> * other technique to gain knowledge of and defuse the BOMB.  BOMB</span></span><br><span class="line"><span class="comment"> * proof clothing may not be worn when handling this program.  The</span></span><br><span class="line"><span class="comment"> * PERPETRATOR will not apologize for the PERPETRATOR&#x27;s poor sense of</span></span><br><span class="line"><span class="comment"> * humor.  This license is null and void where the BOMB is prohibited</span></span><br><span class="line"><span class="comment"> * by law.</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 邪恶博士公司(PerPETRATOR)在此授予您(受害者)明确的许可来使用这个炸弹(the BOMB)。</span></span><br><span class="line"><span class="comment"> * 这是一个有时间限制的许可，在受害者死亡后失效。</span></span><br><span class="line"><span class="comment"> * 对于受害者的损害、挫折、精神错乱、虫眼、腕管综合症、失眠或其他伤害，PerPETRATOR不承担任何责任。 </span></span><br><span class="line"><span class="comment"> * 除非 &quot;保护者 &quot;想邀功，也就是说。受害者不得将此炸弹的源代码分发给PERPETRATOR的任何敌人。</span></span><br><span class="line"><span class="comment"> * 受害者不得调试、逆向工程、运行 &quot;字符串&quot;、反编译、解密或使用任何其他技术来获得对炸弹的了解和拆除炸弹。 </span></span><br><span class="line"><span class="comment"> * 在处理本程序时，不得穿戴防弹衣。</span></span><br><span class="line"><span class="comment"> * PERPETRATOR不会为PERPETRATOR的不良幽默感道歉。</span></span><br><span class="line"><span class="comment"> * 在法律禁止使用BOMB的地方，本许可是无效的。</span></span><br><span class="line"><span class="comment"> ***************************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;support.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;phases.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * Note to self: Remember to erase this file so my victims will have no</span></span><br><span class="line"><span class="comment"> * idea what is going on, and so they will all blow up in a</span></span><br><span class="line"><span class="comment"> * spectaculary fiendish explosion. -- Dr. Evil </span></span><br><span class="line"><span class="comment"> * 自我注意： 记得删除这个文件，这样我的受害者就不会知道发生了什么事，</span></span><br><span class="line"><span class="comment"> * 而且他们都会在一场可怕的魔鬼爆炸中被炸死。-- 邪恶博士</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">FILE *infile;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> *input;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Note to self: remember to port this bomb to Windows and put a </span></span><br><span class="line"><span class="comment">     * fantastic GUI on it. </span></span><br><span class="line"><span class="comment">     请注意：记得把这个炸弹移植到Windows上，并给它装上一个奇妙的GUI。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* When run with no arguments, the bomb reads its input lines </span></span><br><span class="line"><span class="comment">     * from standard input. </span></span><br><span class="line"><span class="comment">     当运行时没有参数，炸弹从标准输入中读取其输入行。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">if</span> (argc == <span class="number">1</span>) &#123;  </span><br><span class="line">	infile = <span class="built_in">stdin</span>;</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="comment">/* When run with one argument &lt;file&gt;, the bomb reads from &lt;file&gt; </span></span><br><span class="line"><span class="comment">     * until EOF, and then switches to standard input. Thus, as you </span></span><br><span class="line"><span class="comment">     * defuse each phase, you can add its defusing string to &lt;file&gt; and</span></span><br><span class="line"><span class="comment">     * avoid having to retype it. </span></span><br><span class="line"><span class="comment">     * 当运行时有一个参数&lt;file&gt;，炸弹从&lt;file&gt;读取，直到EOF，然后切换到标准输入。</span></span><br><span class="line"><span class="comment">     * 因此，当你拆除每个阶段的炸弹时，你可以将其拆除的字符串添加到&lt;file&gt;中，避免重新输入。</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (argc == <span class="number">2</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> (!(infile = fopen(argv[<span class="number">1</span>], <span class="string">&quot;r&quot;</span>))) &#123;</span><br><span class="line">	    <span class="built_in">printf</span>(<span class="string">&quot;%s: Error: Couldn&#x27;t open %s\n&quot;</span>, argv[<span class="number">0</span>], argv[<span class="number">1</span>]);</span><br><span class="line">	    <span class="built_in">exit</span>(<span class="number">8</span>);</span><br><span class="line">	&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* You can&#x27;t call the bomb with more than 1 command line argument. </span></span><br><span class="line"><span class="comment">    你不能用1个以上的命令行参数调用炸弹。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Usage: %s [&lt;input_file&gt;]\n&quot;</span>, argv[<span class="number">0</span>]);</span><br><span class="line">	<span class="built_in">exit</span>(<span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Do all sorts of secret stuff that makes the bomb harder to defuse. </span></span><br><span class="line"><span class="comment">    做各种秘密的事情，使炸弹更难拆除。*/</span></span><br><span class="line">    initialize_bomb();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Welcome to my fiendish little bomb. You have 6 phases with\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;which to blow yourself up. Have a nice day!\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Hmm...  Six phases must be more secure than one phase! </span></span><br><span class="line"><span class="comment">    嗯...  六个阶段一定比一个阶段更安全！！*/</span></span><br><span class="line">    input = read_line();             <span class="comment">/* Get input       获取输入            */</span></span><br><span class="line">    phase_1(input);                  <span class="comment">/* Run the phase        运行阶段      */</span></span><br><span class="line">    phase_defused();                 <span class="comment">/* Drat!  They figured it out!糟了!  他们发现了!</span></span><br><span class="line"><span class="comment">				      * Let me know how they did it. 让我知道他们是如何做到的。*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Phase 1 defused. How about the next one?\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* The second phase is harder.  No one will ever figure out</span></span><br><span class="line"><span class="comment">    第二阶段更难。 没有人能够弄清楚</span></span><br><span class="line"><span class="comment">     * how to defuse this... </span></span><br><span class="line"><span class="comment">     如何化解这...*/</span></span><br><span class="line">    input = read_line();</span><br><span class="line">    phase_2(input);</span><br><span class="line">    phase_defused();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;That&#x27;s number 2.  Keep going!\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* I guess this is too easy so far.  Some more complex code will</span></span><br><span class="line"><span class="comment">     * confuse people. </span></span><br><span class="line"><span class="comment">     我想到目前为止这太容易了。 一些更复杂的代码会使人们感到困惑</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    input = read_line();</span><br><span class="line">    phase_3(input);</span><br><span class="line">    phase_defused();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Halfway there!\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Oh yeah?  Well, how good is your math?  Try on this saucy problem! </span></span><br><span class="line"><span class="comment">    哦，是吗？ 那么，你的数学水平如何？ 试试这个俏皮的问题吧!</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    input = read_line();</span><br><span class="line">    phase_4(input);</span><br><span class="line">    phase_defused();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;So you got that one.  Try this one.\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* Round and &#x27;round in memory we go, where we stop, the bomb blows! </span></span><br><span class="line"><span class="comment">    我们在记忆中绕来绕去，我们在哪里停下来，炸弹就在哪里爆炸!</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    input = read_line();</span><br><span class="line">    phase_5(input);</span><br><span class="line">    phase_defused();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Good work!  On to the next...\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* This phase will never be used, since no one will get past the</span></span><br><span class="line"><span class="comment">     * earlier ones.  But just in case, make this one extra hard. </span></span><br><span class="line"><span class="comment">     这个阶段将永远不会被使用，因为没有人会通过前面的阶段。 </span></span><br><span class="line"><span class="comment">     但为了以防万一，要把这个阶段变得特别难。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    input = read_line();</span><br><span class="line">    phase_6(input);</span><br><span class="line">    phase_defused();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Wow, they got it!  But isn&#x27;t something... missing?  Perhaps</span></span><br><span class="line"><span class="comment">     * something they overlooked?  Mua ha ha ha ha! </span></span><br><span class="line"><span class="comment">     哇，他们得到了它!  但是不是有什么东西......不见了？ 也许他们忽略了什么？ Mua ha ha ha!</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="实验环境"><a href="#实验环境" class="headerlink" title="实验环境"></a>实验环境</h2><p>本实验使用 WSL2 以及 Ubuntu 20.4 完成，编译器为 VS code。</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>由于实验所给的文件中只有一个bomb.c 和一个可执行文件，而bomb.c 并不能直接编译，因此我们只能通过给出的可执行文件来进行分析。将可执行文件通过反汇编得到完整程序的汇编代码，操作如下：</p>
<p>建议创建一个文件，并将反汇编出的代码输入到该文件中，方便后续查看。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linux&gt; objdump -d &gt; objdump.txt</span><br></pre></td></tr></table></figure>
<h2 id="实验解析"><a href="#实验解析" class="headerlink" title="实验解析"></a>实验解析</h2><h3 id="phase-1"><a href="#phase-1" class="headerlink" title="phase_1"></a>phase_1</h3><p><strong>密钥</strong>：The moon unit will be divided into two divisions.</p>
<p>反汇编代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">08048b60 &lt;phase_1&gt;:</span><br><span class="line"> 8048b60:	83 ec 1c             	sub    $0x1c,%esp</span><br><span class="line"> 8048b63:	c7 44 24 04 c4 a1 04 	movl   $0x804a1c4,0x4(%esp)</span><br><span class="line"> 8048b6a:	08 </span><br><span class="line"> 8048b6b:	8b 44 24 20          	mov    0x20(%esp),%eax</span><br><span class="line"> 8048b6f:	89 04 24             	mov    %eax,(%esp)</span><br><span class="line"> 8048b72:	e8 6d 04 00 00       	call   8048fe4 &lt;strings_not_equal&gt; </span><br><span class="line"> 8048b77:	85 c0                	test   %eax,%eax</span><br><span class="line"> 8048b79:	74 05                	je     8048b80 &lt;phase_1+0x20&gt;</span><br><span class="line"> 8048b7b:	e8 76 05 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048b80:	83 c4 1c             	add    $0x1c,%esp</span><br><span class="line"> 8048b83:	c3                   	ret    </span><br></pre></td></tr></table></figure>
<p><strong>分析如下：</strong></p>
<p>结合源代码可以得出 <code>0x20(%esp)</code> 对应的是 bomb.c 中 <code>read_line</code>读入的字符串的首地址。</p>
<p>阅读phase_1的第 2 到第 6行 ，观察到数据 <code>$0x804a1c4</code> 和 <code>0x20(%esp)</code> 均被作为参数传入栈帧中，结合第 7 行的调用 <code>strings_not_equal</code> 函数，可以推测， <code>$0x804a1c4</code> 处存储的也是一个字符串的首地址，并且要与之前读入的字符串进行比较。</p>
<p>查看 <code>strings_not_equal</code> 函数的汇编代码，得知该函数是用于比较两个字符串是否相等的，若相等则返回0，不相等则返回1，返回值均保存在 <code>%eax</code> 中。</p>
<p>继续查看下面的汇编代码，其中第 8 到第 10 行可以得出：当 <code>%eax</code> 为 0 时，跳转到 <code>&lt;phase_1+0x20&gt;</code> 处（即跳过炸弹爆炸）；当 <code>%eax</code> 为 1 时，不会发生跳转，此时炸弹爆炸。</p>
<p>因此我们可以得出结论，当我们输入的字符串与 <code>$0x804a1c4</code> 处存储的字符串<strong>相等</strong>时，就能通过phase_1。</p>
<p>通过 gdb 调试查看 <code>$0x804a1c4</code> 处存储的字符串：</p>
<p><img src="https://raw.githubusercontent.com/zxh3032/save-image/masin/image-20230417093216100.png" alt="image-20230417093216100"></p>
<p>通过 gdb 中的 print 命令，打印出来phase_1的通关密钥。</p>
<h3 id="phase-2"><a href="#phase-2" class="headerlink" title="phase_2"></a>phase_2</h3><p><strong>密钥：</strong>1 2 4 8 16 32</p>
<p>反汇编代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">08048b84 &lt;phase_2&gt;:</span><br><span class="line"> 8048b84:	56                   	push   %esi</span><br><span class="line"> 8048b85:	53                   	push   %ebx</span><br><span class="line"> 8048b86:	83 ec 34             	sub    $0x34,%esp</span><br><span class="line"> 8048b89:	8d 44 24 18          	lea    0x18(%esp),%eax</span><br><span class="line"> 8048b8d:	89 44 24 04          	mov    %eax,0x4(%esp)</span><br><span class="line"> 8048b91:	8b 44 24 40          	mov    0x40(%esp),%eax</span><br><span class="line"> 8048b95:	89 04 24             	mov    %eax,(%esp)</span><br><span class="line"> 8048b98:	e8 8e 06 00 00       	call   804922b &lt;read_six_numbers&gt;</span><br><span class="line"> 8048b9d:	83 7c 24 18 01       	cmpl   $0x1,0x18(%esp) //0x18(%esp)为第一个数字，且必须为1</span><br><span class="line"> 8048ba2:	74 05                	je     8048ba9 &lt;phase_2+0x25&gt;</span><br><span class="line"> 8048ba4:	e8 4d 05 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048ba9:	8d 5c 24 1c          	lea    0x1c(%esp),%ebx</span><br><span class="line"> 8048bad:	8d 74 24 30          	lea    0x30(%esp),%esi</span><br><span class="line"> 8048bb1:	8b 43 fc             	mov    -0x4(%ebx),%eax</span><br><span class="line"> 8048bb4:	01 c0                	add    %eax,%eax //上一个数字的两倍</span><br><span class="line"> 8048bb6:	39 03                	cmp    %eax,(%ebx) //第二个数字是第一个数字的两倍，2</span><br><span class="line"> 8048bb8:	74 05                	je     8048bbf &lt;phase_2+0x3b&gt;</span><br><span class="line"> 8048bba:	e8 37 05 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048bbf:	83 c3 04             	add    $0x4,%ebx</span><br><span class="line"> 8048bc2:	39 f3                	cmp    %esi,%ebx</span><br><span class="line"> 8048bc4:	75 eb                	jne    8048bb1 &lt;phase_2+0x2d&gt; //如果当前这个数的下一个数是第6个输入的值，跳出循环</span><br><span class="line"> 8048bc6:	83 c4 34             	add    $0x34,%esp</span><br><span class="line"> 8048bc9:	5b                   	pop    %ebx</span><br><span class="line"> 8048bca:	5e                   	pop    %esi</span><br><span class="line"> 8048bcb:	c3                   	ret </span><br></pre></td></tr></table></figure>
<p>可以看到phase_2中调用了一个交 <code>read_six_numbers</code> 的函数，反汇编如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">0804922b &lt;read_six_numbers&gt;:</span><br><span class="line"> 804922b:	83 ec 2c             	sub    $0x2c,%esp</span><br><span class="line"> 804922e:	8b 44 24 34          	mov    0x34(%esp),%eax</span><br><span class="line"> 8049232:	8d 50 14             	lea    0x14(%eax),%edx</span><br><span class="line"> 8049235:	89 54 24 1c          	mov    %edx,0x1c(%esp)</span><br><span class="line"> 8049239:	8d 50 10             	lea    0x10(%eax),%edx</span><br><span class="line"> 804923c:	89 54 24 18          	mov    %edx,0x18(%esp)</span><br><span class="line"> 8049240:	8d 50 0c             	lea    0xc(%eax),%edx</span><br><span class="line"> 8049243:	89 54 24 14          	mov    %edx,0x14(%esp)</span><br><span class="line"> 8049247:	8d 50 08             	lea    0x8(%eax),%edx</span><br><span class="line"> 804924a:	89 54 24 10          	mov    %edx,0x10(%esp)</span><br><span class="line"> 804924e:	8d 50 04             	lea    0x4(%eax),%edx</span><br><span class="line"> 8049251:	89 54 24 0c          	mov    %edx,0xc(%esp)</span><br><span class="line"> 8049255:	89 44 24 08          	mov    %eax,0x8(%esp)</span><br><span class="line"> 8049259:	c7 44 24 04 d7 a3 04 	movl   $0x804a3d7,0x4(%esp)</span><br><span class="line"> 8049260:	08 </span><br><span class="line"> 8049261:	8b 44 24 30          	mov    0x30(%esp),%eax</span><br><span class="line"> 8049265:	89 04 24             	mov    %eax,(%esp)</span><br><span class="line"> 8049268:	e8 03 f6 ff ff       	call   8048870 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line"> 804926d:	83 f8 05             	cmp    $0x5,%eax</span><br><span class="line"> 8049270:	7f 05                	jg     8049277 &lt;read_six_numbers+0x4c&gt;</span><br><span class="line"> 8049272:	e8 7f fe ff ff       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8049277:	83 c4 2c             	add    $0x2c,%esp</span><br><span class="line"> 804927a:	c3                   	ret    </span><br></pre></td></tr></table></figure>
<p>从函数的名字我们也不难猜出该函数的作用，读取 6 个数字。注意到 <code>8049259</code> 这一行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8049259:	c7 44 24 04 d7 a3 04 	movl   $0x804a3d7,0x4(%esp)</span><br></pre></td></tr></table></figure>
<p>这里在 <code>0x4(%esp)</code> 里存了一个地址，输出一下看看是什么。</p>
<p><img src="https://raw.githubusercontent.com/zxh3032/save-image/masin/image-20230417094147134.png" alt="image-20230417094147134"></p>
<p>想来这个就是输入函数 sscanf 的格式了，果不其然是输入6个数字。</p>
<p>已知 <code>read_six_numbers</code> 函数的作用，我们再次回到 phase_2的汇编代码中。第 10 行的 <code>cmpl   $0x1,0x18(%esp)</code>表明第一个数字必须为 1，否则炸弹直接爆炸。</p>
<p>由第 13 行到第 22 行，我们可以看出，每次将下一个数字的地址给到寄存器 <code>%ebx</code>，将当前数字给到寄存器 <code>%eax</code> ，再将 <code>%eax</code> 中的值做乘 2 处理，最后将  <code>%ebx</code> 地址处的值与 <code>%eax</code> 中的值作比较，相等则继续循环，不等则炸弹爆炸。循环结束的条件是 6 个数字全部比较结束。</p>
<p>因此输入的 6 个数字应该为：<code>1 2 4 8 16 32</code></p>
<h3 id="phase-3"><a href="#phase-3" class="headerlink" title="phase_3"></a>phase_3</h3><p><strong>密钥：</strong>0 -418 或 1 -906 或 2 -536 或 3 -639 或 4 0 或 5 -639</p>
<p>反汇编代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">08048bcc &lt;phase_3&gt;:</span><br><span class="line"> 8048bcc:	83 ec 2c             	sub    $0x2c,%esp</span><br><span class="line"> 8048bcf:	8d 44 24 1c          	lea    0x1c(%esp),%eax</span><br><span class="line"> 8048bd3:	89 44 24 0c          	mov    %eax,0xc(%esp)</span><br><span class="line"> 8048bd7:	8d 44 24 18          	lea    0x18(%esp),%eax</span><br><span class="line"> 8048bdb:	89 44 24 08          	mov    %eax,0x8(%esp)</span><br><span class="line"> 8048bdf:	c7 44 24 04 e3 a3 04 	movl   $0x804a3e3,0x4(%esp) //该处地址内容为 &quot;%d %d&quot;，说明调用下一步的函数要输入两个整形</span><br><span class="line"> 8048be6:	08 </span><br><span class="line"> 8048be7:	8b 44 24 30          	mov    0x30(%esp),%eax</span><br><span class="line"> 8048beb:	89 04 24             	mov    %eax,(%esp)</span><br><span class="line"> 8048bee:	e8 7d fc ff ff       	call   8048870 &lt;__isoc99_sscanf@plt&gt; //返回值为输入参数的个数，小于2则炸弹爆炸</span><br><span class="line"> 8048bf3:	83 f8 01             	cmp    $0x1,%eax</span><br><span class="line"> 8048bf6:	7f 05                	jg     8048bfd &lt;phase_3+0x31&gt;</span><br><span class="line"> 8048bf8:	e8 f9 04 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048bfd:	83 7c 24 18 07       	cmpl   $0x7,0x18(%esp) </span><br><span class="line"> 8048c02:	77 64                	ja     8048c68 &lt;phase_3+0x9c&gt; //如果第一个参数超过 7 ，则爆炸</span><br><span class="line"> 8048c04:	8b 44 24 18          	mov    0x18(%esp),%eax</span><br><span class="line"> 8048c08:	ff 24 85 20 a2 04 08 	jmp    *0x804a220(,%eax,4)</span><br><span class="line"> 8048c0f:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line"> 8048c14:	eb 05                	jmp    8048c1b &lt;phase_3+0x4f&gt;</span><br><span class="line"> 8048c16:	b8 e8 01 00 00       	mov    $0x1e8,%eax</span><br><span class="line"> 8048c1b:	2d 72 01 00 00       	sub    $0x172,%eax						减172</span><br><span class="line"> 8048c20:	eb 05                	jmp    8048c27 &lt;phase_3+0x5b&gt;</span><br><span class="line"> 8048c22:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line"> 8048c27:	83 c0 67             	add    $0x67,%eax						加67</span><br><span class="line"> 8048c2a:	eb 05                	jmp    8048c31 &lt;phase_3+0x65&gt;</span><br><span class="line"> 8048c2c:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line"> 8048c31:	2d 7f 02 00 00       	sub    $0x27f,%eax						减27f</span><br><span class="line"> 8048c36:	eb 05                	jmp    8048c3d &lt;phase_3+0x71&gt;</span><br><span class="line"> 8048c38:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line"> 8048c3d:	05 7f 02 00 00       	add    $0x27f,%eax						加27f</span><br><span class="line"> 8048c42:	eb 05                	jmp    8048c49 &lt;phase_3+0x7d&gt;</span><br><span class="line"> 8048c44:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line"> 8048c49:	2d 7f 02 00 00       	sub    $0x27f,%eax						减27f</span><br><span class="line"> 8048c4e:	eb 05                	jmp    8048c55 &lt;phase_3+0x89&gt;</span><br><span class="line"> 8048c50:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line"> 8048c55:	05 7f 02 00 00       	add    $0x27f,%eax						加27f</span><br><span class="line"> 8048c5a:	eb 05                	jmp    8048c61 &lt;phase_3+0x95&gt;</span><br><span class="line"> 8048c5c:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line"> 8048c61:	2d 7f 02 00 00       	sub    $0x27f,%eax						减27f</span><br><span class="line"> 8048c66:	eb 0a                	jmp    8048c72 &lt;phase_3+0xa6&gt;</span><br><span class="line"> 8048c68:	e8 89 04 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048c6d:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line"> 8048c72:	83 7c 24 18 05       	cmpl   $0x5,0x18(%esp) //第一个参数的取值范围为 【0， 5】</span><br><span class="line"> 8048c77:	7f 06                	jg     8048c7f &lt;phase_3+0xb3&gt;</span><br><span class="line"> 8048c79:	3b 44 24 1c          	cmp    0x1c(%esp),%eax //第二个参数与 eax作比较，</span><br><span class="line"> 8048c7d:	74 05                	je     8048c84 &lt;phase_3+0xb8&gt; //相等结束，否则爆炸</span><br><span class="line"> 8048c7f:	e8 72 04 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048c84:	83 c4 2c             	add    $0x2c,%esp</span><br><span class="line"> 8048c87:	c3                   	ret    </span><br></pre></td></tr></table></figure>
<p><strong>分析：</strong></p>
<p>第 3 ~ 11 行是为scanf函数配置参数以及执行scanf函数的过程，用 print 查看<code>0x804a3e3</code> 中的内容，发现是 <code>&quot;%d %d&quot;</code> ，说明 scanf 读取的是两个整型数字，即密钥是由两个整数组成的。从第 12 行可以看出，当输入的参数个数小于 2 时，炸弹就会爆炸。</p>
<p>第15 ~ 16行，<code>0x18(%esp)</code>中存储的是输入的第一个数，<code>ja</code> 指令意味着无符号指令的大小比较，可以推断出第一个数的取值范围是[0,7]。</p>
<p>第 18 行代码是一个变址寻址的地址跳转，跳转的地址为<code>*(0x804a200+(%eax)*4)</code> ，使用 gdb 输出 <code>0x804a200</code> 地址处的 8 个值（因为输入的第一个参数为0~7，合理推测此处最多只有 8 个值）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/8wx 0x804a220</span><br><span class="line">0x804a220:      0x08048c16      0x08048c0f      0x08048c22      0x08048c2c</span><br><span class="line">0x804a230:      0x08048c38      0x08048c44      0x08048c50      0x08048c5c</span><br></pre></td></tr></table></figure>
<p>可以看出，<code>0x804a220</code>之后存储的 8 个值都是要跳转的地址。跳转后就会执行各种加或减的操作。一系列操作后，第44 ~ 45行代码又将第一个参数的取值范围缩小至[0,5]。第46 ~ 47行代码则是将操作后得到的数与我们输入的第二个参数相比较，相等则函数结束，不相等则炸弹爆炸。</p>
<p>因此要得出所有的答案，只需要在第18行跳转完成后计算出加减操作得到的最后的值，就是我们要输入的第二个数。</p>
<h3 id="phase-4"><a href="#phase-4" class="headerlink" title="phase_4"></a>phase_4</h3><p><strong>密钥：</strong>11 18</p>
<p>反汇编代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">08048cf1 &lt;phase_4&gt;:</span><br><span class="line"> 8048cf1:	83 ec 2c             	sub    $0x2c,%esp</span><br><span class="line"> 8048cf4:	8d 44 24 1c          	lea    0x1c(%esp),%eax</span><br><span class="line"> 8048cf8:	89 44 24 0c          	mov    %eax,0xc(%esp)</span><br><span class="line"> 8048cfc:	8d 44 24 18          	lea    0x18(%esp),%eax</span><br><span class="line"> 8048d00:	89 44 24 08          	mov    %eax,0x8(%esp)</span><br><span class="line"> 8048d04:	c7 44 24 04 e3 a3 04 	movl   $0x804a3e3,0x4(%esp)</span><br><span class="line"> 8048d0b:	08 </span><br><span class="line"> 8048d0c:	8b 44 24 30          	mov    0x30(%esp),%eax</span><br><span class="line"> 8048d10:	89 04 24             	mov    %eax,(%esp)</span><br><span class="line"> 8048d13:	e8 58 fb ff ff       	call   8048870 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line"> 8048d18:	83 f8 02             	cmp    $0x2,%eax</span><br><span class="line"> 8048d1b:	75 0d                	jne    8048d2a &lt;phase_4+0x39&gt; //输入参数不等于2时，炸弹爆炸</span><br><span class="line"> 8048d1d:	8b 44 24 18          	mov    0x18(%esp),%eax  //第一个参数</span><br><span class="line"> 8048d21:	85 c0                	test   %eax,%eax  //</span><br><span class="line"> 8048d23:	78 05                	js     8048d2a &lt;phase_4+0x39&gt; //第一个参数为负数时，炸弹爆炸</span><br><span class="line"> 8048d25:	83 f8 0e             	cmp    $0xe,%eax </span><br><span class="line"> 8048d28:	7e 05                	jle    8048d2f &lt;phase_4+0x3e&gt; //eax（第一个参数）应该小于等于 14，否则爆炸</span><br><span class="line"> 8048d2a:	e8 c7 03 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048d2f:	c7 44 24 08 0e 00 00 	movl   $0xe,0x8(%esp) 调用函数func，第三个参数是 14，第二个参数是 0，第一个参数为输入的第一个值</span><br><span class="line"> 8048d36:	00 </span><br><span class="line"> 8048d37:	c7 44 24 04 00 00 00 	movl   $0x0,0x4(%esp) </span><br><span class="line"> 8048d3e:	00 </span><br><span class="line"> 8048d3f:	8b 44 24 18          	mov    0x18(%esp),%eax </span><br><span class="line"> 8048d43:	89 04 24             	mov    %eax,(%esp)</span><br><span class="line"> 8048d46:	e8 3d ff ff ff       	call   8048c88 &lt;func4&gt;</span><br><span class="line"> 8048d4b:	83 f8 12             	cmp    $0x12,%eax	//比较返回值与18的大小，返回值不等于18，则炸弹爆炸</span><br><span class="line"> 8048d4e:	75 07                	jne    8048d57 &lt;phase_4+0x66&gt;</span><br><span class="line"> 8048d50:	83 7c 24 1c 12       	cmpl   $0x12,0x1c(%esp) //比较第二个输入值与18的大小，不等于则炸弹爆炸</span><br><span class="line"> 8048d55:	74 05                	je     8048d5c &lt;phase_4+0x6b&gt;</span><br><span class="line"> 8048d57:	e8 9a 03 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048d5c:	83 c4 2c             	add    $0x2c,%esp</span><br><span class="line"> 8048d5f:	c3                   	ret </span><br></pre></td></tr></table></figure>
<p>有第 7 行的 <code>0x804a3e3</code>地址处所存的内容以及第 12 行将 scanf 函数的返回值与 2 作比较，可以得出输入的是两个参数，且参数类型为整形。</p>
<p><img src="https://raw.githubusercontent.com/zxh3032/save-image/masin/image-20230422153859139.png" alt="image-20230422153859139"></p>
<p>由第 14 ~ 18 行分析可得，输入的第一个参数的取值范围应该是 [0, 14]。第 20 ~ 26 行，主函数调用 func4 函数，并将(x, 0, 14)作为函数的三个参数传入(x 表示我们输入的第一个参数)。以下是 <code>func4</code> 函数的反汇编代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">08048c88 &lt;func4&gt;:A</span><br><span class="line"> 8048c88:	83 ec 1c             	sub    $0x1c,%esp</span><br><span class="line"> 8048c8b:	89 5c 24 14          	mov    %ebx,0x14(%esp)</span><br><span class="line"> 8048c8f:	89 74 24 18          	mov    %esi,0x18(%esp)</span><br><span class="line"> 8048c93:	8b 44 24 20          	mov    0x20(%esp),%eax	//a = x</span><br><span class="line"> 8048c97:	8b 54 24 24          	mov    0x24(%esp),%edx	//b = 0</span><br><span class="line"> 8048c9b:	8b 74 24 28          	mov    0x28(%esp),%esi	//c = 14</span><br><span class="line"> 8048c9f:	89 f1                	mov    %esi,%ecx</span><br><span class="line"> 8048ca1:	29 d1                	sub    %edx,%ecx		//d = c - b</span><br><span class="line"> 8048ca3:	89 cb                	mov    %ecx,%ebx		</span><br><span class="line"> 8048ca5:	c1 eb 1f             	shr    $0x1f,%ebx		//d进行逻辑右移31位，取出其符号位，e = d&gt;&gt;31</span><br><span class="line"> 8048ca8:	01 d9                	add    %ebx,%ecx		//d = d + e </span><br><span class="line"> 8048caa:	d1 f9                	sar    %ecx				//对d进行符号位拓展</span><br><span class="line"> 8048cac:	8d 1c 11             	lea    (%ecx,%edx,1),%ebx	//f = (b + d)</span><br><span class="line"> 8048caf:	39 c3                	cmp    %eax,%ebx			//比较f与a的大小</span><br><span class="line"> 8048cb1:	7e 17                	jle    8048cca &lt;func4+0x42&gt; //如果 f &lt;= a 则发生跳转</span><br><span class="line"> 8048cb3:	8d 4b ff             	lea    -0x1(%ebx),%ecx		//f - 1 -&gt; ecx</span><br><span class="line"> 8048cb6:	89 4c 24 08          	mov    %ecx,0x8(%esp)		//f-1 为第三个参数</span><br><span class="line"> 8048cba:	89 54 24 04          	mov    %edx,0x4(%esp)		//b 为第二个参数</span><br><span class="line"> 8048cbe:	89 04 24             	mov    %eax,(%esp)			//a 为第一个参数</span><br><span class="line"> 8048cc1:	e8 c2 ff ff ff       	call   8048c88 &lt;func4&gt;		</span><br><span class="line"> 8048cc6:	01 c3                	add    %eax,%ebx			//eax保存func4的返回值</span><br><span class="line"> 8048cc8:	eb 19                	jmp    8048ce3 &lt;func4+0x5b&gt;</span><br><span class="line"> 8048cca:	39 c3                	cmp    %eax,%ebx			</span><br><span class="line"> 8048ccc:	7d 15                	jge    8048ce3 &lt;func4+0x5b&gt;	//如果 f &gt;= a 发生跳转</span><br><span class="line"> 8048cce:	89 74 24 08          	mov    %esi,0x8(%esp)</span><br><span class="line"> 8048cd2:	8d 53 01             	lea    0x1(%ebx),%edx</span><br><span class="line"> 8048cd5:	89 54 24 04          	mov    %edx,0x4(%esp)</span><br><span class="line"> 8048cd9:	89 04 24             	mov    %eax,(%esp)</span><br><span class="line"> 8048cdc:	e8 a7 ff ff ff       	call   8048c88 &lt;func4&gt;</span><br><span class="line"> 8048ce1:	01 c3                	add    %eax,%ebx</span><br><span class="line"> 8048ce3:	89 d8                	mov    %ebx,%eax</span><br><span class="line"> 8048ce5:	8b 5c 24 14          	mov    0x14(%esp),%ebx</span><br><span class="line"> 8048ce9:	8b 74 24 18          	mov    0x18(%esp),%esi</span><br><span class="line"> 8048ced:	83 c4 1c             	add    $0x1c,%esp</span><br><span class="line"> 8048cf0:	c3                   	ret</span><br></pre></td></tr></table></figure>
<p>这个函数有点绕，大概是做一个二分，具体的内容写在注释里，自己可以用笔模拟下这个函数在干嘛，可以推断出C语言代码大致如下:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">func</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)</span>&#123;</span><br><span class="line">	<span class="type">int</span> d = c - b;</span><br><span class="line">	<span class="type">int</span> e = (d &gt;&gt; <span class="number">31</span>) &amp; <span class="number">1</span>;</span><br><span class="line">	d = (d + e) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">	<span class="type">int</span> f = b + d;</span><br><span class="line">	<span class="keyword">if</span>(a &lt; f)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">int</span> g = func4(a, b, f<span class="number">-1</span>);</span><br><span class="line">		<span class="keyword">return</span> g + f;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(a &gt; f)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">int</span> g = func4(a , f+<span class="number">1</span>, c);</span><br><span class="line">		<span class="keyword">return</span> g + f;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从 <code>func4</code> 函数中返回后，第 27 行代码将函数的返回值与 <code>0x12</code> 作比较，不相等时炸弹直接爆炸，相等则继续下面的判断。第 29 行代码显示将输入的第二个值与 <code>0x12</code> 作比较，当不相等时发生爆炸，相等则安全退出函数。由推断出的 <code>func4</code> 的C语言代码可尝试在输入[0, 14]时，函数的不同返回值。只有当输入值为 11 时，返回值才是18，即与 <code>0x12</code> 相等。由此便可推出密钥为 <code>11 18</code>。</p>
<h3 id="phase-5"><a href="#phase-5" class="headerlink" title="phase_5"></a>phase_5</h3><p><strong>密钥：</strong>bcejno 或 cdeijn 或 cejlmn（只列出了极少的情况，全部可能应该有几万种可能）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">08048d60 &lt;phase_5&gt;:</span><br><span class="line"> 8048d60:	53                   	push   %ebx</span><br><span class="line"> 8048d61:	83 ec 18             	sub    $0x18,%esp</span><br><span class="line"> 8048d64:	8b 5c 24 20          	mov    0x20(%esp),%ebx</span><br><span class="line"> 8048d68:	89 1c 24             	mov    %ebx,(%esp)</span><br><span class="line"> 8048d6b:	e8 5b 02 00 00       	call   8048fcb &lt;string_length&gt;//获取输入字符串的长度</span><br><span class="line"> 8048d70:	83 f8 06             	cmp    $0x6,%eax </span><br><span class="line"> 8048d73:	74 05                	je     8048d7a &lt;phase_5+0x1a&gt; //输入字符串的长度不等于 6 ，炸弹爆炸</span><br><span class="line"> 8048d75:	e8 7c 03 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048d7a:	ba 00 00 00 00       	mov    $0x0,%edx</span><br><span class="line"> 8048d7f:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line"> 8048d84:	0f be 0c 03          	movsbl (%ebx,%eax,1),%ecx</span><br><span class="line"> 8048d88:	83 e1 0f             	and    $0xf,%ecx</span><br><span class="line"> 8048d8b:	03 14 8d 40 a2 04 08 	add    0x804a240(,%ecx,4),%edx</span><br><span class="line"> 8048d92:	83 c0 01             	add    $0x1,%eax</span><br><span class="line"> 8048d95:	83 f8 06             	cmp    $0x6,%eax</span><br><span class="line"> 8048d98:	75 ea                	jne    8048d84 &lt;phase_5+0x24&gt;</span><br><span class="line"> 8048d9a:	83 fa 41             	cmp    $0x41,%edx</span><br><span class="line"> 8048d9d:	74 05                	je     8048da4 &lt;phase_5+0x44&gt;</span><br><span class="line"> 8048d9f:	e8 52 03 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048da4:	83 c4 18             	add    $0x18,%esp</span><br><span class="line"> 8048da7:	5b                   	pop    %ebx</span><br><span class="line"> 8048da8:	c3                   	ret</span><br></pre></td></tr></table></figure>
<p>分析前 8 行代码可知，输入值为一个字符串，且长度一定要是 6，否则炸弹直接爆炸。接下来就是一个循环结构，遍历输入的字符串，并将当前遍历的字节与 <code>oxf</code> 相与得到一个值，得到的值将作为首地址在 <code>0x804a240</code> 处的整数数组的下标，并将访问的值进行累加，若和为 <code>0x41</code> ，则该字符串就是密钥，否则炸弹爆炸。下面是该函数的C语言代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> s[<span class="number">6</span>] = 输入的字符串</span><br><span class="line"><span class="type">int</span> a[<span class="number">16</span>] = 首地址在<span class="number">0x804a220</span>处的数组，由于和<span class="number">0xf</span>相与，故下标最大值为<span class="number">15</span>，数组长度为<span class="number">16</span></span><br><span class="line"><span class="type">int</span> sum = <span class="number">0</span>; <span class="comment">//累加和</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> pos = (<span class="type">int</span>)s[i] &amp; <span class="number">0xf</span>;</span><br><span class="line">    sum += a[pos];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(sum != <span class="number">0x41</span>)</span><br><span class="line">    explode_bomb();</span><br></pre></td></tr></table></figure>
<p>查看 <code>0x804a240</code> 地址处的长度为 16 的整数数组的全部值：</p>
<p><img src="https://raw.githubusercontent.com/zxh3032/save-image/masin/image-20230409222538168.png" alt="image-20230409222538168"></p>
<p>每个整数值对应的字母大小写如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x804a240 &lt;array.2999&gt;: 		2-p\P       10-a\q\A\Q      6-b\r\B\Q       1-c\s\C\S</span><br><span class="line">0x804a250 &lt;array.2999+16&gt;:      12-d\t\D\T      16-E\U\e\u      9-F\V\f\v       3-g\w\G\W</span><br><span class="line">0x804a260 &lt;array.2999+32&gt;:      4-H\X\h\x       7-I\Y\i\y       14-j\z\J\Z      5-k\K</span><br><span class="line">0x804a270 &lt;array.2999+48&gt;:      11-L\l      8-M\m       15-N\n      13-o\O</span><br></pre></td></tr></table></figure>
<p>全部不重复的情况如下（没有任何参考价值，尽量不要尝试算出所有的情况）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">[1, 6, 13, 14, 15, 16], </span><br><span class="line">[1, 7, 12, 14, 15, 16],</span><br><span class="line">[1, 8, 11, 14, 15, 16],</span><br><span class="line">[1, 8, 12, 13, 15, 16], </span><br><span class="line">[1, 9, 10, 14, 15, 16], </span><br><span class="line">[1, 9, 11, 13, 15, 16], </span><br><span class="line">[1, 9, 12, 13, 14, 16], </span><br><span class="line">[1, 10, 11, 12, 15, 16], </span><br><span class="line">[1, 10, 11, 13, 14, 16],</span><br><span class="line">[1, 10, 12, 13, 14, 15], </span><br><span class="line">[2, 5, 13, 14, 15, 16], </span><br><span class="line">[2, 6, 12, 14, 15, 16], </span><br><span class="line">[2, 7, 11, 14, 15, 16], </span><br><span class="line">[2, 7, 12, 13, 15, 16], </span><br><span class="line">[2, 8, 10, 14, 15, 16], </span><br><span class="line">[2, 8, 11, 13, 15, 16], </span><br><span class="line">[2, 8, 12, 13, 14, 16], </span><br><span class="line">[2, 9, 10, 13, 15, 16], </span><br><span class="line">[2, 9, 11, 12, 15, 16], </span><br><span class="line">[2, 9, 11, 13, 14, 16], </span><br><span class="line">[2, 9, 12, 13, 14, 15], </span><br><span class="line">[2, 10, 11, 12, 14, 16],</span><br><span class="line">[2, 10, 11, 13, 14, 15],</span><br><span class="line">[3, 4, 13, 14, 15, 16], </span><br><span class="line">[3, 5, 12, 14, 15, 16], </span><br><span class="line">[3, 6, 11, 14, 15, 16], </span><br><span class="line">[3, 6, 12, 13, 15, 16], </span><br><span class="line">[3, 7, 10, 14, 15, 16], </span><br><span class="line">[3, 7, 11, 13, 15, 16], </span><br><span class="line">[3, 7, 12, 13, 14, 16], </span><br><span class="line">[3, 8, 9, 14, 15, 16], </span><br><span class="line">[3, 8, 10, 13, 15, 16],</span><br><span class="line">[3, 8, 11, 12, 15, 16],</span><br><span class="line">[3, 8, 11, 13, 14, 16],</span><br><span class="line">[3, 8, 12, 13, 14, 15], </span><br><span class="line">[3, 9, 10, 12, 15, 16], </span><br><span class="line">[3, 9, 10, 13, 14, 16], </span><br><span class="line">[3, 9, 11, 12, 14, 16],</span><br><span class="line">[3, 9, 11, 13, 14, 15], </span><br><span class="line">[3, 10, 11, 12, 13, 16],</span><br><span class="line">[3, 10, 11, 12, 14, 15],</span><br><span class="line">[4, 5, 11, 14, 15, 16], </span><br><span class="line">[4, 5, 12, 13, 15, 16],</span><br><span class="line">[4, 6, 10, 14, 15, 16],</span><br><span class="line">[4, 6, 11, 13, 15, 16],</span><br><span class="line">[4, 6, 12, 13, 14, 16], </span><br><span class="line">[4, 7, 9, 14, 15, 16], </span><br><span class="line">[4, 7, 10, 13, 15, 16],</span><br><span class="line">[4, 7, 11, 12, 15, 16], </span><br><span class="line">[4, 7, 11, 13, 14, 16],</span><br><span class="line">[4, 7, 12, 13, 14, 15], </span><br><span class="line">[4, 8, 9, 13, 15, 16], </span><br><span class="line">[4, 8, 10, 12, 15, 16],</span><br><span class="line">[4, 8, 10, 13, 14, 16],</span><br><span class="line">[4, 8, 11, 12, 14, 16], </span><br><span class="line">[4, 8, 11, 13, 14, 15],</span><br><span class="line">[4, 9, 10, 11, 15, 16], </span><br><span class="line">[4, 9, 10, 12, 14, 16], </span><br><span class="line">[4, 9, 10, 13, 14, 15],</span><br><span class="line">[4, 9, 11, 12, 13, 16],</span><br><span class="line">[4, 9, 11, 12, 14, 15], </span><br><span class="line">[4, 10, 11, 12, 13, 15],</span><br><span class="line">[5, 6, 9, 14, 15, 16], </span><br><span class="line">[5, 6, 10, 13, 15, 16],</span><br><span class="line">[5, 6, 11, 12, 15, 16], </span><br><span class="line">[5, 6, 11, 13, 14, 16], </span><br><span class="line">[5, 6, 12, 13, 14, 15], </span><br><span class="line">[5, 7, 8, 14, 15, 16], </span><br><span class="line">[5, 7, 9, 13, 15, 16], </span><br><span class="line">[5, 7, 10, 12, 15, 16], </span><br><span class="line">[5, 7, 10, 13, 14, 16], </span><br><span class="line">[5, 7, 11, 12, 14, 16], </span><br><span class="line">[5, 7, 11, 13, 14, 15], </span><br><span class="line">[5, 8, 9, 12, 15, 16], </span><br><span class="line">[5, 8, 9, 13, 14, 16],</span><br><span class="line">[5, 8, 10, 11, 15, 16],</span><br><span class="line">[5, 8, 10, 12, 14, 16],</span><br><span class="line">[5, 8, 10, 13, 14, 15],</span><br><span class="line">[5, 8, 11, 12, 13, 16], </span><br><span class="line">[5, 8, 11, 12, 14, 15],</span><br><span class="line">[5, 9, 10, 11, 14, 16], </span><br><span class="line">[5, 9, 10, 12, 13, 16],</span><br><span class="line">[5, 9, 10, 12, 14, 15],</span><br><span class="line">[5, 9, 11, 12, 13, 15], </span><br><span class="line">[5, 10, 11, 12, 13, 14],</span><br><span class="line">[6, 7, 8, 13, 15, 16], </span><br><span class="line">[6, 7, 9, 12, 15, 16], </span><br><span class="line">[6, 7, 9, 13, 14, 16],</span><br><span class="line">[6, 7, 10, 11, 15, 16],</span><br><span class="line">[6, 7, 10, 12, 14, 16],</span><br><span class="line">[6, 7, 10, 13, 14, 15],</span><br><span class="line">[6, 7, 11, 12, 13, 16], </span><br><span class="line">[6, 7, 11, 12, 14, 15],</span><br><span class="line">[6, 8, 9, 11, 15, 16], </span><br><span class="line">[6, 8, 9, 12, 14, 16],</span><br><span class="line">[6, 8, 9, 13, 14, 15], </span><br><span class="line">[6, 8, 10, 11, 14, 16], </span><br><span class="line">[6, 8, 10, 12, 13, 16], </span><br><span class="line">[6, 8, 10, 12, 14, 15], </span><br><span class="line">[6, 8, 11, 12, 13, 15],</span><br><span class="line">[6, 9, 10, 11, 13, 16], </span><br><span class="line">[6, 9, 10, 11, 14, 15], </span><br><span class="line">[6, 9, 10, 12, 13, 15], </span><br><span class="line">[6, 9, 11, 12, 13, 14], </span><br><span class="line">[7, 8, 9, 10, 15, 16], </span><br><span class="line">[7, 8, 9, 11, 14, 16],</span><br><span class="line">[7, 8, 9, 12, 13, 16], </span><br><span class="line">[7, 8, 9, 12, 14, 15], </span><br><span class="line">[7, 8, 10, 11, 13, 16],</span><br><span class="line">[7, 8, 10, 11, 14, 15], </span><br><span class="line">[7, 8, 10, 12, 13, 15], </span><br><span class="line">[7, 8, 11, 12, 13, 14], </span><br><span class="line">[7, 9, 10, 11, 12, 16], </span><br><span class="line">[7, 9, 10, 11, 13, 15], </span><br><span class="line">[7, 9, 10, 12, 13, 14], </span><br><span class="line">[8, 9, 10, 11, 12, 15], </span><br><span class="line">[8, 9, 10, 11, 13, 14]</span><br><span class="line"></span><br><span class="line">一共有117种可能</span><br></pre></td></tr></table></figure>
<h3 id="phase-6"><a href="#phase-6" class="headerlink" title="phase_6"></a>phase_6</h3><p><strong>密钥：</strong>4 2 3 6 5 1 或 4 2 6 3 5 1</p>
<p>反汇编代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">08048da9 &lt;phase_6&gt;:</span><br><span class="line"> 8048da9:	56                   	push   %esi</span><br><span class="line"> 8048daa:	53                   	push   %ebx</span><br><span class="line"> 8048dab:	83 ec 44             	sub    $0x44,%esp</span><br><span class="line"> 8048dae:	8d 44 24 10          	lea    0x10(%esp),%eax</span><br><span class="line"> 8048db2:	89 44 24 04          	mov    %eax,0x4(%esp)</span><br><span class="line"> 8048db6:	8b 44 24 50          	mov    0x50(%esp),%eax</span><br><span class="line"> 8048dba:	89 04 24             	mov    %eax,(%esp)</span><br><span class="line"> 8048dbd:	e8 69 04 00 00       	call   804922b &lt;read_six_numbers&gt;</span><br><span class="line"> 8048dc2:	be 00 00 00 00       	mov    $0x0,%esi				/* </span><br><span class="line"> 8048dc7:	8b 44 b4 10          	mov    0x10(%esp,%esi,4),%eax</span><br><span class="line"> 8048dcb:	83 e8 01             	sub    $0x1,%eax</span><br><span class="line"> 8048dce:	83 f8 05             	cmp    $0x5,%eax </span><br><span class="line"> 8048dd1:	76 05                	jbe    8048dd8 &lt;phase_6+0x2f&gt;</span><br><span class="line"> 8048dd3:	e8 1e 03 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048dd8:	83 c6 01             	add    $0x1,%esi</span><br><span class="line"> 8048ddb:	83 fe 06             	cmp    $0x6,%esi</span><br><span class="line"> 8048dde:	74 33                	je     8048e13 &lt;phase_6+0x6a&gt; </span><br><span class="line"> 8048de0:	89 f3                	mov    %esi,%ebx</span><br><span class="line"> 8048de2:	8b 44 9c 10          	mov    0x10(%esp,%ebx,4),%eax		6个数字都要小于等于6，并且大于等于1</span><br><span class="line"> 8048de6:	39 44 b4 0c          	cmp    %eax,0xc(%esp,%esi,4) 		且不能两两相等</span><br><span class="line"> 8048dea:	75 05                	jne    8048df1 &lt;phase_6+0x48&gt;		否则炸弹爆炸</span><br><span class="line"> 8048dec:	e8 05 03 00 00       	call   80490f6 &lt;explode_bomb&gt;	</span><br><span class="line"> 8048df1:	83 c3 01             	add    $0x1,%ebx</span><br><span class="line"> 8048df4:	83 fb 05             	cmp    $0x5,%ebx</span><br><span class="line"> 8048df7:	7e e9                	jle    8048de2 &lt;phase_6+0x39&gt; </span><br><span class="line"> 8048df9:	eb cc                	jmp    8048dc7 &lt;phase_6+0x1e&gt;	*/</span><br><span class="line"> 8048dfb:	8b 52 08             	mov    0x8(%edx),%edx</span><br><span class="line"> 8048dfe:	83 c0 01             	add    $0x1,%eax</span><br><span class="line"> 8048e01:	39 c8                	cmp    %ecx,%eax				//使ecx的值与输入值相等</span><br><span class="line"> 8048e03:	75 f6                	jne    8048dfb &lt;phase_6+0x52&gt;</span><br><span class="line"> 8048e05:	89 54 b4 28          	mov    %edx,0x28(%esp,%esi,4)</span><br><span class="line"> 8048e09:	83 c3 01             	add    $0x1,%ebx</span><br><span class="line"> 8048e0c:	83 fb 06             	cmp    $0x6,%ebx</span><br><span class="line"> 8048e0f:	75 07                	jne    8048e18 &lt;phase_6+0x6f&gt;</span><br><span class="line"> 8048e11:	eb 1c                	jmp    8048e2f &lt;phase_6+0x86&gt;</span><br><span class="line"> 8048e13:	bb 00 00 00 00       	mov    $0x0,%ebx</span><br><span class="line"> 8048e18:	89 de                	mov    %ebx,%esi</span><br><span class="line"> 8048e1a:	8b 4c 9c 10          	mov    0x10(%esp,%ebx,4),%ecx</span><br><span class="line"> 8048e1e:	b8 01 00 00 00       	mov    $0x1,%eax</span><br><span class="line"> 8048e23:	ba 3c c1 04 08       	mov    $0x804c13c,%edx</span><br><span class="line"> 8048e28:	83 f9 01             	cmp    $0x1,%ecx 			//输入的数字大于 1 发生跳转</span><br><span class="line"> 8048e2b:	7f ce                	jg     8048dfb &lt;phase_6+0x52&gt;</span><br><span class="line"> 8048e2d:	eb d6                	jmp    8048e05 &lt;phase_6+0x5c&gt;</span><br><span class="line"> 8048e2f:	8b 5c 24 28          	mov    0x28(%esp),%ebx 		j0 -&gt; ebx</span><br><span class="line"> 8048e33:	8b 44 24 2c          	mov    0x2c(%esp),%eax		j1 -&gt; eax</span><br><span class="line"> 8048e37:	89 43 08             	mov    %eax,0x8(%ebx)		j1 -&gt; ebx+8</span><br><span class="line"> 8048e3a:	8b 54 24 30          	mov    0x30(%esp),%edx		j2 -&gt; edx</span><br><span class="line"> 8048e3e:	89 50 08             	mov    %edx,0x8(%eax)		j2 -&gt; eax+8</span><br><span class="line"> 8048e41:	8b 44 24 34          	mov    0x34(%esp),%eax		j3 -&gt; eax</span><br><span class="line"> 8048e45:	89 42 08             	mov    %eax,0x8(%edx)		j3 -&gt; edx+8</span><br><span class="line"> 8048e48:	8b 54 24 38          	mov    0x38(%esp),%edx		j4 -&gt; edx</span><br><span class="line"> 8048e4c:	89 50 08             	mov    %edx,0x8(%eax)		j4 -&gt; eax+8</span><br><span class="line"> 8048e4f:	8b 44 24 3c          	mov    0x3c(%esp),%eax		j5 -&gt; eax</span><br><span class="line"> 8048e53:	89 42 08             	mov    %eax,0x8(%edx)		j5 -&gt; edx+8</span><br><span class="line"> 8048e56:	c7 40 08 00 00 00 00 	movl   $0x0,0x8(%eax)		0 -&gt; eax+8</span><br><span class="line"> 8048e5d:	be 05 00 00 00       	mov    $0x5,%esi			esi = 5</span><br><span class="line"> 8048e62:	8b 43 08             	mov    0x8(%ebx),%eax		eax = j1</span><br><span class="line"> 8048e65:	8b 10                	mov    (%eax),%edx 			</span><br><span class="line"> 8048e67:	39 13                	cmp    %edx,(%ebx)			j1与j0比较 </span><br><span class="line"> 8048e69:	7d 05                	jge    8048e70 &lt;phase_6+0xc7&gt;</span><br><span class="line"> 8048e6b:	e8 86 02 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048e70:	8b 5b 08             	mov    0x8(%ebx),%ebx</span><br><span class="line"> 8048e73:	83 ee 01             	sub    $0x1,%esi</span><br><span class="line"> 8048e76:	75 ea                	jne    8048e62 &lt;phase_6+0xb9&gt;</span><br><span class="line"> 8048e78:	83 c4 44             	add    $0x44,%esp</span><br><span class="line"> 8048e7b:	5b                   	pop    %ebx</span><br><span class="line"> 8048e7c:	5e                   	pop    %esi</span><br><span class="line"> 8048e7d:	c3                   	ret </span><br></pre></td></tr></table></figure>
<p>由第 9 行代码可以得出我们一共输入 6 个整型数字。分析后面的代码可得，输入的 6 个值的取值范围为[1, 6]，且不能两两相等。第 28 ~ 44 行是一个循环结构，用于比较当前数字与后一个数字的大小，前一个数一定不能小于后一个数，否则炸弹直接爆炸。其中要进行比较的数组为以 <code>0x804c13c</code> 为首地址的数组。</p>
<p>但是在输出该地址的内容后，发现这并不是一个数组，而是一个结构体，每个结构体中有3个元素，一个记录数值、一个记录node编号，一个存放下一个node的地址（可以把node理解为链表），共占12个字节。</p>
<p>存储node的方式是：按照读入的6个数（假定为a[i]），将编号为a[i]的node存储到第i个位置。然后从栈帧中的存储的第一个node开始，每个node与其后一个node中的数值进行比较，若后大于前，则会引爆炸弹。以下是打印出的 6 个node的信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0x804c13c &lt;node1&gt;:    99      1       134529352       </span><br><span class="line">0x804c148 &lt;node2&gt;:    476	  2       134529364       </span><br><span class="line">0x804c154 &lt;node3&gt;:    208     3		  134529376       </span><br><span class="line">0x804c160 &lt;node4&gt;:    740     4       134529388		  </span><br><span class="line">0x804c16c &lt;node5&gt;:	  135     5       134529400       </span><br><span class="line">0x804c178 &lt;node6&gt;:    208	  6             	      </span><br></pre></td></tr></table></figure>
<p>由此可以的出密钥应该是 4 2 3 6 5 1 或 4 2 6 3 5 1（因为6 与 3中的值是相等的，所以可以调换顺序）。</p>
<h3 id="答案"><a href="#答案" class="headerlink" title="答案"></a>答案</h3><p>至此，我们以及得出了六个关卡的正确密钥，如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">The moon unit will be divided into two divisions.</span><br><span class="line">1 2 4 8 16 32</span><br><span class="line">4 0</span><br><span class="line">11 18</span><br><span class="line">bcejno</span><br><span class="line">4 2 3 6 5 1</span><br></pre></td></tr></table></figure>
<p>输入以上六个密钥，便可拆除炸弹。</p>
<p>但是，不知道你有没有注意到在该程序的源代码中的结尾处有一行注释，如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/* Wow, they got it!  But isn&#x27;t something... missing?  Perhaps</span><br><span class="line">     * something they overlooked?  Mua ha ha ha ha! </span><br><span class="line">     哇，他们得到了它!  但是不是有什么东西......不见了？ 也许他们忽略了什么？ Mua ha ha ha!</span><br><span class="line">     */</span><br></pre></td></tr></table></figure>
<p>这就十分可疑，再结合源代码中每个关卡在输出正确答案提示之前都调用了同一个函数——<code>phase_defused();</code>，下面的这个部分就是探寻隐藏关卡的部分。</p>
<h3 id="隐藏关卡"><a href="#隐藏关卡" class="headerlink" title="隐藏关卡"></a>隐藏关卡</h3><p><strong>密钥：</strong> 107</p>
<p><code>phase_defused</code>函数的反汇编代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">0804927b &lt;phase_defused&gt;:</span><br><span class="line"> 804927b:	81 ec 8c 00 00 00    	sub    $0x8c,%esp</span><br><span class="line"> 8049281:	65 a1 14 00 00 00    	mov    %gs:0x14,%eax</span><br><span class="line"> 8049287:	89 44 24 7c          	mov    %eax,0x7c(%esp)</span><br><span class="line"> 804928b:	31 c0                	xor    %eax,%eax</span><br><span class="line"> 804928d:	83 3d cc c3 04 08 06 	cmpl   $0x6,0x804c3cc //该地址处存储的是通过的个数，如果没有全部通过，则不会进入隐藏关卡</span><br><span class="line"> 8049294:	75 72                	jne    8049308 &lt;phase_defused+0x8d&gt;</span><br><span class="line"> 8049296:	8d 44 24 2c          	lea    0x2c(%esp),%eax	</span><br><span class="line"> 804929a:	89 44 24 10          	mov    %eax,0x10(%esp)		//第一个参数</span><br><span class="line"> 804929e:	8d 44 24 28          	lea    0x28(%esp),%eax</span><br><span class="line"> 80492a2:	89 44 24 0c          	mov    %eax,0xc(%esp)		//第二个参数</span><br><span class="line"> 80492a6:	8d 44 24 24          	lea    0x24(%esp),%eax</span><br><span class="line"> 80492aa:	89 44 24 08          	mov    %eax,0x8(%esp)		//第三个参数</span><br><span class="line"> 80492ae:	c7 44 24 04 e9 a3 04 	movl   $0x804a3e9,0x4(%esp) //0x804a3e9 &quot;%d %d %s&quot;,输入参数为两个整形个一个字符串，只有第三关和第四关符合条件，测试后应该是在第四关输入特殊字符串，进入隐藏关卡</span><br><span class="line"> 80492b5:	08 </span><br><span class="line"> 80492b6:	c7 04 24 d0 c4 04 08 	movl   $0x804c4d0,(%esp)</span><br><span class="line"> 80492bd:	e8 ae f5 ff ff       	call   8048870 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line"> 80492c2:	83 f8 03             	cmp    $0x3,%eax			//输入参数一定要是3个，否则退出函数</span><br><span class="line"> 80492c5:	75 35                	jne    80492fc &lt;phase_defused+0x81&gt;</span><br><span class="line"> 80492c7:	c7 44 24 04 f2 a3 04 	movl   $0x804a3f2,0x4(%esp) //0x804a3f2:      &quot;DrEvil&quot;</span><br><span class="line"> 80492ce:	08 </span><br><span class="line"> 80492cf:	8d 44 24 2c          	lea    0x2c(%esp),%eax</span><br><span class="line"> 80492d3:	89 04 24             	mov    %eax,(%esp)</span><br><span class="line"> 80492d6:	e8 09 fd ff ff       	call   8048fe4 &lt;strings_not_equal&gt;//调用比较字符串的函数，说明该地址处的字符串有关键作用</span><br><span class="line"> 80492db:	85 c0                	test   %eax,%eax		//eax为0表示两个字符串相等，否则不相等</span><br><span class="line"> 80492dd:	75 1d                	jne    80492fc &lt;phase_defused+0x81&gt;</span><br><span class="line"> 80492df:	c7 04 24 b8 a2 04 08 	movl   $0x804a2b8,(%esp) //0x804a2b8:      &quot;Curses, you&#x27;ve found the secret phase!&quot;</span><br><span class="line"> 80492e6:	e8 15 f5 ff ff       	call   8048800 &lt;puts@plt&gt; //输出字符串</span><br><span class="line"> 80492eb:	c7 04 24 e0 a2 04 08 	movl   $0x804a2e0,(%esp) //0x804a2e0:      &quot;But finding it and solving it are quite different...&quot;</span><br><span class="line"> 80492f2:	e8 09 f5 ff ff       	call   8048800 &lt;puts@plt&gt; //输出字符串</span><br><span class="line"> 80492f7:	e8 d3 fb ff ff       	call   8048ecf &lt;secret_phase&gt; //进入隐藏关卡</span><br><span class="line"> 80492fc:	c7 04 24 18 a3 04 08 	movl   $0x804a318,(%esp) //0x804a318:      &quot;Congratulations! You&#x27;ve defused the bomb!&quot;</span><br><span class="line"> 8049303:	e8 f8 f4 ff ff       	call   8048800 &lt;puts@plt&gt;//输出字符串</span><br><span class="line"> 8049308:	8b 44 24 7c          	mov    0x7c(%esp),%eax</span><br><span class="line"> 804930c:	65 33 05 14 00 00 00 	xor    %gs:0x14,%eax</span><br><span class="line"> 8049313:	74 05                	je     804931a &lt;phase_defused+0x9f&gt;</span><br><span class="line"> 8049315:	e8 b6 f4 ff ff       	call   80487d0 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line"> 804931a:	81 c4 8c 00 00 00    	add    $0x8c,%esp</span><br><span class="line"> 8049320:	c3                   	ret    </span><br><span class="line"> 8049321:	90                   	nop</span><br><span class="line"> 8049322:	90                   	nop</span><br><span class="line"> 8049323:	90                   	nop</span><br><span class="line"> 8049324:	90                   	nop</span><br><span class="line"> 8049325:	90                   	nop</span><br><span class="line"> 8049326:	90                   	nop</span><br><span class="line"> 8049327:	90                   	nop</span><br><span class="line"> 8049328:	90                   	nop</span><br><span class="line"> 8049329:	90                   	nop</span><br><span class="line"> 804932a:	90                   	nop</span><br><span class="line"> 804932b:	90                   	nop</span><br><span class="line"> 804932c:	90                   	nop</span><br><span class="line"> 804932d:	90                   	nop</span><br><span class="line"> 804932e:	90                   	nop</span><br><span class="line"> 804932f:	90                   	nop</span><br></pre></td></tr></table></figure>
<p><strong>分析</strong></p>
<p>在找到 <code>phase_defused</code> 函数的反汇编之后，不难找到几个有助于我们分析关键部分，如下：</p>
<ul>
<li>第 6 行将地址 <code>0x804c3cc</code> 处的值与 6 作比较；</li>
<li>第 8 ~ 18 行调用 <code>__isoc99_sscanf@plt</code> 函数，其中第 14 和第 18 行为分析的关键点；</li>
<li>第 20 行将 <code>0x804a3f2</code> 地址处的值传给寄存器；</li>
<li>第 24 行调用比较字符串函数；</li>
<li>第 27 ~ 30 行输出两次地址中的值；</li>
<li>第 31 行调用名为 <code>secret_phase</code> 的函数；</li>
<li>第 32 ~ 33 行输出地址 <code>0x804a318</code> 中的值。</li>
</ul>
<p>根据以上关键点，我们可以得出以下结论：</p>
<ul>
<li><p>第 6 行， 地址 <code>0x804c3cc</code> 中的值应该是当前通过的数目，只有通关数为 6 时才迈出了进入隐藏关卡的第一步；</p>
</li>
<li><p>第 8 ~ 18 行，调用输入函数，且由第 18 行得知输入的参数的个数应该是 3 个；由第 14 行可知，三个参数的类型为前两个是整形，第三个是字符串类型。</p>
<p>因为一共要输入两个整数和一个字符串，且每次在解决一个关卡后都会调用该函数。由此可得，前两个整数应该是某一个关卡的密钥。而在我们得出得答案中，只有第 3 关和第 4 关的密钥是两个整型数字，经过测试后，隐藏关卡的实际入口在第4关</p>
<p><img src="https://raw.githubusercontent.com/zxh3032/save-image/masin/image-20230418194052316.png" alt="image-20230418194052316"></p>
</li>
<li><p>输出第 20 行地址处的值为：<code>DrEvil</code> ；</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/zxh3032/save-image/masin/image-20230418194200376.png" alt="image-20230418194200376"></p>
<ul>
<li>比较函数用于将第 20 行地址处的字符串与输入的第三个参数作比较，根据后面两行的代码可以分析出当输入值与设置值不相等时，会直接打印祝贺信息并退出该函数，只有当两个字符串相等时，我们操迈出了进入隐藏关卡的第二步。</li>
<li>第 27 ~ 30 行，一共输出了两个地址存储的值，打印出来后发现并没有什么实质价值，只是成功输入字符串的隐藏值。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/zxh3032/save-image/masin/image-20230418195114104.png" alt="image-20230418195114104"></p>
<ul>
<li>第 31 行，被调用的函数就是隐藏关卡，反汇编代码如下：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">08048ecf &lt;secret_phase&gt;:</span><br><span class="line"> 8048ecf:	53                   	push   %ebx</span><br><span class="line"> 8048ed0:	83 ec 18             	sub    $0x18,%esp</span><br><span class="line"> 8048ed3:	e8 45 02 00 00       	call   804911d &lt;read_line&gt;</span><br><span class="line"> 8048ed8:	c7 44 24 08 0a 00 00 	movl   $0xa,0x8(%esp) //第一个参数10</span><br><span class="line"> 8048edf:	00 </span><br><span class="line"> 8048ee0:	c7 44 24 04 00 00 00 	movl   $0x0,0x4(%esp) //第二个参数0</span><br><span class="line"> 8048ee7:	00 </span><br><span class="line"> 8048ee8:	89 04 24             	mov    %eax,(%esp) //第三个参数为输入值</span><br><span class="line"> 8048eeb:	e8 f0 f9 ff ff       	call   80488e0 &lt;strtol@plt&gt;//转化为十进制数</span><br><span class="line"> 8048ef0:	89 c3                	mov    %eax,%ebx</span><br><span class="line"> 8048ef2:	8d 40 ff             	lea    -0x1(%eax),%eax</span><br><span class="line"> 8048ef5:	3d e8 03 00 00       	cmp    $0x3e8,%eax</span><br><span class="line"> 8048efa:	76 05                	jbe    8048f01 &lt;secret_phase+0x32&gt; //输入值-1 小于等于 0x3e8的话跳转，炸弹不爆炸</span><br><span class="line"> 8048efc:	e8 f5 01 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048f01:	89 5c 24 04          	mov    %ebx,0x4(%esp)</span><br><span class="line"> 8048f05:	c7 04 24 88 c0 04 08 	movl   $0x804c088,(%esp)</span><br><span class="line"> 8048f0c:	e8 6d ff ff ff       	call   8048e7e &lt;fun7&gt;</span><br><span class="line"> 8048f11:	83 f8 03             	cmp    $0x3,%eax //函数fun7的返回值与 3 作比较，等于 3 炸弹不爆炸</span><br><span class="line"> 8048f14:	74 05                	je     8048f1b &lt;secret_phase+0x4c&gt;</span><br><span class="line"> 8048f16:	e8 db 01 00 00       	call   80490f6 &lt;explode_bomb&gt;</span><br><span class="line"> 8048f1b:	c7 04 24 f8 a1 04 08 	movl   $0x804a1f8,(%esp) //0x804a1f8:      &quot;Wow! You&#x27;ve defused the secret stage!&quot;</span><br><span class="line"> 8048f22:	e8 d9 f8 ff ff       	call   8048800 &lt;puts@plt&gt;//输出字符串</span><br><span class="line"> 8048f27:	e8 4f 03 00 00       	call   804927b &lt;phase_defused&gt; //返回调用函数</span><br><span class="line"> 8048f2c:	83 c4 18             	add    $0x18,%esp</span><br><span class="line"> 8048f2f:	5b                   	pop    %ebx</span><br><span class="line"> 8048f30:	c3                   	ret    </span><br><span class="line"> 8048f31:	90                   	nop</span><br><span class="line"> 8048f32:	90                   	nop</span><br><span class="line"> 8048f33:	90                   	nop</span><br><span class="line"> 8048f34:	90                   	nop</span><br><span class="line"> 8048f35:	90                   	nop</span><br><span class="line"> 8048f36:	90                   	nop</span><br><span class="line"> 8048f37:	90                   	nop</span><br><span class="line"> 8048f38:	90                   	nop</span><br><span class="line"> 8048f39:	90                   	nop</span><br><span class="line"> 8048f3a:	90                   	nop</span><br><span class="line"> 8048f3b:	90                   	nop</span><br><span class="line"> 8048f3c:	90                   	nop</span><br><span class="line"> 8048f3d:	90                   	nop</span><br><span class="line"> 8048f3e:	90                   	nop</span><br><span class="line"> 8048f3f:	90                   	nop</span><br></pre></td></tr></table></figure>
<p>进入secret_phase，函数先读取我们输入的密钥，然后调用了c语言的strtol函数，这个函数将字符串转为长整型数，其中参数0xa意味着将其转为十进制。接下来函数会比较经转换后的数自减1后与0x3e8（十进制为1000）的无符号数大小，这意味着我们输入的数必须在[1, 1001]中。接着，函数会调用一个递归函数func7，参数为0x804c088和我们输入的数，func7的伪代码如下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">func7</span><span class="params">(<span class="type">int</span>* k, <span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">       <span class="keyword">if</span>(k &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">       <span class="type">int</span> kn = *k;</span><br><span class="line">       <span class="keyword">if</span>(kn == n) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">       <span class="keyword">else</span> <span class="keyword">if</span>(kn &lt; n) <span class="keyword">return</span> <span class="number">2</span>*func7(k+<span class="number">2</span>, n) + <span class="number">1</span>;</span><br><span class="line">       <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">2</span>*func7(k+<span class="number">1</span>, n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>又由以下两个指令知，<code>func7(, 我们输入的数)</code>的返回值必须为3，否则将引爆炸弹。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">8048ef2: 83 f8 03              cmp    $0x3,%eax</span><br><span class="line">8048ef5: 74 05                 je     8048efc &lt;secret_phase+0x4c&gt;</span><br></pre></td></tr></table></figure>
<p>观察内存中地址为0x804c088的内容，是一棵二叉树：第一个地址存储数据，第二、三个地址存储下子结点的地址。于是我们只要分析func7的行为，并根据0x804c088中的内容，即可确定要输入的数。</p>
<p>首先，函数要求func7最终返回3。要构造一个3，根据func7的特性，可以这样构造$2\cdot(2\cdot(0+1))+1$ ，这意味着，最后一次要返回 0，倒数第二次（或第二次）要返回 $2 \cdot func7(k+2, n) + 1$，倒数第三次（或第一次）要返回 $2 \cdot func7(k+2, n) + 1$ 。或者说，要返回的值是二叉树查找时比较的次数。要满足这样的关系，假如我们把第1~3次比较的数设为k1、k2、k3，那么，我们输入的数n要满足的条件是n &gt; k1且n &gt; k2且n == k3。要找到k3，查找0x804c088处的内存即可，经查找，为0x6b，转换为十进制为107，即为密钥。</p>
<p>打印 <code>0x804c088</code> 地址处的值可得：</p>
<p><img src="https://raw.githubusercontent.com/zxh3032/save-image/masin/image-20230418201622434.png" alt="image-20230418201622434"></p>
<p>所以，隐藏关卡的密钥为 <code>107</code> 。</p>
<p>下图为实验结果：</p>
<p><img src="https://raw.githubusercontent.com/zxh3032/save-image/masin/image-20230418205634637.png" alt="image-20230418205634637"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>写到此处，我们的炸弹也就拆完了。在拆除炸弹之后，有关于x86-64的汇编指令以及gdb的一些调试方法我们都已经有所了解。总的来说，这个实验还是十分有趣的，通过剧情让我们了解汇编指令，值得自己独立研究一下，会有不小的收获。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">随便寻个地方</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2023/04/18/Bomb-Lab/">http://example.com/2023/04/18/Bomb-Lab/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">随便寻个地方'Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/touxiang.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/07/31/%E4%BB%80%E4%B9%88%E6%98%AF%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%EF%BC%88namespace%EF%BC%89/" title="什么是命名空间（namespace）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">什么是命名空间（namespace）</div></div></a></div><div class="next-post pull-right"><a href="/2023/03/28/%E5%B0%8F%E5%AD%94%E6%88%90%E5%83%8F%E6%A8%A1%E5%9E%8B%E2%80%94%E2%80%94%E5%9D%90%E6%A0%87%E7%B3%BB%E8%BD%AC%E6%8D%A2/" title="小孔成像模型——坐标系转换"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">小孔成像模型——坐标系转换</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">随便寻个地方</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">43</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Bomb-Lab"><span class="toc-number">1.</span> <span class="toc-text">Bomb Lab</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C%E8%AF%AD%E8%A8%80%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">1.2.</span> <span class="toc-text">C语言源代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83"><span class="toc-number">1.3.</span> <span class="toc-text">实验环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.4.</span> <span class="toc-text">准备工作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A7%A3%E6%9E%90"><span class="toc-number">1.5.</span> <span class="toc-text">实验解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-1"><span class="toc-number">1.5.1.</span> <span class="toc-text">phase_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-2"><span class="toc-number">1.5.2.</span> <span class="toc-text">phase_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-3"><span class="toc-number">1.5.3.</span> <span class="toc-text">phase_3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-4"><span class="toc-number">1.5.4.</span> <span class="toc-text">phase_4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-5"><span class="toc-number">1.5.5.</span> <span class="toc-text">phase_5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-6"><span class="toc-number">1.5.6.</span> <span class="toc-text">phase_6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%94%E6%A1%88"><span class="toc-number">1.5.7.</span> <span class="toc-text">答案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%90%E8%97%8F%E5%85%B3%E5%8D%A1"><span class="toc-number">1.5.8.</span> <span class="toc-text">隐藏关卡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.6.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/13/Redis%E9%AB%98%E5%8F%AF%E7%94%A8%E5%AE%9D%E5%85%B8%EF%BC%9A%E4%B8%89%E6%8B%9B%E6%90%9E%E5%AE%9A%E4%BD%A0%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A0%A1%E5%9E%92/" title="Redis高可用宝典：三招搞定你的数据堡垒">Redis高可用宝典：三招搞定你的数据堡垒</a><time datetime="2024-06-13T11:10:16.000Z" title="发表于 2024-06-13 19:10:16">2024-06-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/12/Java%E5%85%AB%E8%82%A1%E6%96%87%E2%80%94%E2%80%94%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%88%E4%BA%8C%EF%BC%89/" title="Java八股文——基础篇（二）">Java八股文——基础篇（二）</a><time datetime="2024-06-12T13:42:11.000Z" title="发表于 2024-06-12 21:42:11">2024-06-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/12/Redis%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6%EF%BC%9A%E9%AB%98%E6%95%88%E8%BF%90%E8%A1%8C%E7%9A%84%E7%A7%98%E5%AF%86%E6%AD%A6%E5%99%A8/" title="Redis事件机制：高效运行的秘密武器">Redis事件机制：高效运行的秘密武器</a><time datetime="2024-06-12T12:35:25.000Z" title="发表于 2024-06-12 20:35:25">2024-06-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/11/Redis%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%EF%BC%9A%E4%BD%A0%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%8C%E9%9A%8F%E6%97%B6%E5%BE%85%E5%91%BD/" title="Redis消息队列：你的数据，随时待命">Redis消息队列：你的数据，随时待命</a><time datetime="2024-06-11T15:07:23.000Z" title="发表于 2024-06-11 23:07:23">2024-06-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/11/Java%E5%85%AB%E8%82%A1%E6%96%87%E2%80%94%E2%80%94%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%88%E4%B8%80%EF%BC%89/" title="Java八股文——基础篇（一）">Java八股文——基础篇（一）</a><time datetime="2024-06-11T11:43:48.000Z" title="发表于 2024-06-11 19:43:48">2024-06-11</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 随便寻个地方</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container').forEach(node => {
            if (node.hasAttribute('display')) {
              btf.wrap(node, 'div', { class: 'mathjax-overflow' })
            } else {
              btf.wrap(node, 'span', { class: 'mathjax-overflow' })
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>